<div class="order-form">
  <h3>{{ isEditMode ? 'Edit Order #' + order?.id : 'Add New Order' }}</h3>

  @if (!studentId) {
    <div class="info-message">
      Please select a student to create an order.
    </div>
  }

  @if (errorMessage()) {
    <div class="error-message">
      {{ errorMessage() }}
    </div>
  }

  <form [formGroup]="orderForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="total">Total Amount *</label>
      <input
        type="number"
        id="total"
        formControlName="total"
        [class.error]="hasError('total')"
        placeholder="0.00"
        step="0.01"
        min="0.01"
        autofocus
      />
      @if (hasError('total')) {
        <div class="field-error">
          {{ getFieldError('total') }}
        </div>
      }
    </div>

    <div class="form-group">
      <label for="status">Status *</label>
      <select
        id="status"
        formControlName="status"
        [class.error]="hasError('status')"
      >
        <option value="pending">Pending</option>
        <option value="paid">Paid</option>
      </select>
      @if (hasError('status')) {
        <div class="field-error">
          {{ getFieldError('status') }}
        </div>
      }
    </div>

    @if (isEditMode) {
      <div class="form-group">
        <label for="createdAt">Date *</label>
        <input
          type="date"
          id="createdAt"
          formControlName="createdAt"
          [class.error]="hasError('createdAt')"
        />
        @if (hasError('createdAt')) {
          <div class="field-error">
            {{ getFieldError('createdAt') }}
          </div>
        }
      </div>
    }

    <div class="form-actions">
      <button
        type="button"
        class="btn-secondary"
        (click)="onCancel()"
      >
        Cancel
      </button>
      <button
        type="submit"
        [disabled]="orderForm.invalid || submitting() || !studentId"
        class="btn-primary"
      >
        @if (!submitting()) {
          <span>{{ isEditMode ? 'Save Changes' : 'Create Order' }}</span>
        } @else {
          <span>{{ isEditMode ? 'Saving...' : 'Creating...' }}</span>
        }
      </button>
    </div>
  </form>
</div>
